//---------------------------------------------------------------------------

#ifndef WndUtilsH
#define WndUtilsH
//---------------------------------------------------------------------------

#include <windows.h>
#include "BotClasses.h"

//*************************************************************************
// Subclassing - методы организации механизма сабкласинга (подмены оконной
//				 процедуры)
//*************************************************************************

// Список окон которым подменили оконную процедуру
typedef PList WNDPROCLIST;

//  Информация о подменённой процедуре
typedef struct TWndProcInfo
{
	HWND    Window;       // Окно для которого была произведена подмена
	bool    IsUnicode;    // Признак UNICODE окна
	WNDPROC OriginalProc; // Оригинальная процедура

} *PWndProcInfo;



namespace SubClassing
{
	//--------------------------------------------------------------
	//  CreateList - функция создаёт список хранения информации
	//               о подмененых процедурах.
	//               Функция является простой оболочкой для
	//--------------------------------------------------------------
	WNDPROCLIST CreateList();

	//--------------------------------------------------------------
	//  SetWindowProc -  Функция подменяет оконную процедуру
	//
	//  List  - Список, куда сохранится результат подмены в случае
	//			успешной подмены
	//
	//  Wnd - Окно для которого необходимо произвести подмену
	//
	//  NewProc - Новая оконная процедура
	//
	//  Результат: В случае успеха функция вернёт указатель на
	//             структуру с сохранёнными данными
	//--------------------------------------------------------------
	PWndProcInfo SetWindowProc(WNDPROCLIST List, HWND Wnd, WNDPROC NewProc);


	//--------------------------------------------------------------
	//  RestoreWndProc - Функция восстанавливает оригинальную
	//					 оконную процедуру
	//
	//  List - список произведённых подмен
	//
	//  Wnd - Окно которому необхопроцедурудимо восстановить
	//--------------------------------------------------------------
	void RestoreWndProc(WNDPROCLIST List, HWND Wnd);

	//--------------------------------------------------------------
	//  CallOriginalProc - Функция вызывает ориганальную оконную
	//                     процедуру
	//--------------------------------------------------------------
	LRESULT CallOriginalProc(WNDPROCLIST List, HWND Wnd, UINT Msg, WPARAM WParam, LPARAM LParam);
}



//--------------------------------------------------------------
//  AllocateWND - Функция создаёт окно
//--------------------------------------------------------------
HWND AllocateWND(WNDPROC WndProc);

//--------------------------------------------------------------
//  GetWNDText - Функция возвращает текст окна
//--------------------------------------------------------------
PCHAR GetWNDText(HWND Wnd);



//---------------------------------------------------------------------------
#endif
